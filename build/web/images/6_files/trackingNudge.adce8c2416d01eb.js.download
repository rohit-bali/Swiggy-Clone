webpackJsonp(["trackingNudge"],{"/CEQ":function(t,e){t.exports={container:"_1fKtX",slideUp:"_196wm",containerHide:"n32Go",slideDown:"_3_QG2",iconCtr:"_2NntA",icon:"_3vDYu",iconImg:"_3HGxr",content:"_3tCc7",contentTitle:"_1bDpd",contentDescription:"SOIk0",contentStatus:"_3dVrx",contentETA:"_27u1i",lineProgressBar:"_1W_YY"}},JXTd:function(t,e,n){"use strict";n.d(e,"v",function(){return i}),n.d(e,"m",function(){return u}),n.d(e,"r",function(){return c}),n.d(e,"c",function(){return a}),n.d(e,"j",function(){return s}),n.d(e,"d",function(){return l}),n.d(e,"b",function(){return d}),n.d(e,"y",function(){return f}),n.d(e,"w",function(){return _}),n.d(e,"g",function(){return p}),n.d(e,"x",function(){return b}),n.d(e,"u",function(){return m}),n.d(e,"t",function(){return g}),n.d(e,"D",function(){return h}),n.d(e,"E",function(){return v}),n.d(e,"s",function(){return O}),n.d(e,"p",function(){return y}),n.d(e,"q",function(){return j}),n.d(e,"B",function(){return k}),n.d(e,"k",function(){return w}),n.d(e,"i",function(){return T}),n.d(e,"l",function(){return M}),n.d(e,"h",function(){return E}),n.d(e,"n",function(){return P}),n.d(e,"o",function(){return N}),n.d(e,"a",function(){return x}),n.d(e,"e",function(){return I}),n.d(e,"z",function(){return A}),n.d(e,"A",function(){return D}),n.d(e,"C",function(){return S}),n.d(e,"f",function(){return W});var r=n("8VeI"),o=n("AdWY"),i=function(t){return t.restaurant?{lat:Number(t.restaurant.lat),lng:Number(t.restaurant.lng)}:{lat:null,lng:null}},u=function(t){return t.billing_address?{lat:Number(t.billing_address.lat),lng:Number(t.billing_address.lng)}:{lat:null,lng:null}},c=function(t){return t.polylines?t.polylines.map(function(t){return t.points}):[]},a=function(t,e,n,r){if(t==e&&e==r)return 0;var o=Math.PI*t/180,i=Math.PI*n/180,u=e-r,c=Math.PI*u/180,a=Math.sin(o)*Math.sin(i)+Math.cos(o)*Math.cos(i)*Math.cos(c);return a=60*(a=180*(a=Math.acos(a))/Math.PI)*1.1515*1.609344*1e3},s=function(t){return t.delivery_boy?{lat:Number(t.delivery_boy.lat),lng:Number(t.delivery_boy.lng)}:{lat:null,lng:null}},l=function(t){return!!Number(t.flag_for_expand)},d=function(t){return e=t,!Object(o.o)(e,"configurations.de_live_tracking_disabled",0);var e},f=function(t){return d(t)?"":Object(o.o)(t,"messages.0.title","")},_=function(t){return r.d},p=function(t){switch(Object(o.o)(t,"annotation","").toUpperCase()){case"HOME":return r.n;case"WORK":return r.w;default:return r.d}},b=function(t){return d(t)?"":Object(o.o)(t,"messages.0.subtitle","")},m=function(t){return d(t)?"":Object(o.o)(t,"message_help.title","")},g=function(t){return d(t)?"":Object(o.o)(t,"message_help.description","")},h=function(t){return!d(t)&&!!Object(o.o)(t,"message_help.ask_confirmation",0)},v=function(t){if(d(t))return!1;if(!t.message_help)return!1;var e=O(t);return!(!h(t)&&0===e.length)},O=function(t){return t.outlet_contact_number||""},y=function(t){return Object(o.o)(t,"message","")},j=function(t){var e=Object(o.o)(t,"message_position_number",0);return Number(e)},k=function(t){var e=t.delivery_status;return"unassigned"!==e&&"assigned"!==e},w=function(t){return Object(o.o)(t,"delivery_boy_mobile","")},T=function(t){return t.image_url},M=function(t){return t.delivery_boy_name},E=function(t){return Object(o.o)(t,"delay_message","")},P=function(t){var e="";switch(t.annotation&&(e=t.annotation.toUpperCase()),e){case"HOME":return"Home";case"WORK":return"Work";default:return!1}},N=function(t){return t.expected_time},x=function(t){return!!t.show_eta},I=function(t){return t.batched_order_message},A=function(t){return t.status_code===r.b},D=function(t){return j(t)===r.x},S=function(t){var e=l(t),n=D(t),r=A(t);return e||n||r},W=function(t){var e=[];return t.batched_destinations?(t.batched_destinations.map(function(t){e.push({lat:Number(t.lat),lng:Number(t.lng)})}),e):e}},QgIF:function(t,e,n){"use strict";n.d(e,"f",function(){return u}),n.d(e,"e",function(){return c}),n.d(e,"g",function(){return a}),n.d(e,"h",function(){return s}),n.d(e,"b",function(){return l}),n.d(e,"d",function(){return d}),n.d(e,"c",function(){return f}),n.d(e,"a",function(){return _});var r=n("8VeI"),o=n("AdWY"),i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(r=(u=c.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(t,e){return t===e},c=function(t,e){var n=t.position,r=t.nowText,o=t.doneText,i=t.nextText,u=t.futureText;return n==e?r:n<e?o:n-e==1?i:u},a=function(t,e){return t>e},s=function(t){return t.length<26?t:t.substring(0,23)+"..."},l=function(t){var e=t.split(" "),n=i(e,2),r=n[0],o=n[1],u=r.split("-"),c=i(u,3),a=c[0],s=c[1],l=c[2],d=o.split(":"),f=i(d,3),_=f[0],p=f[1],b=f[2],m=new Date(a,s,l,_,p,b),g=m.getHours(),h=m.getMinutes(),v=" AM";return 0==g?g=12:g>=12&&(g>12&&(g%=12),v=" PM"),g<10&&(g="0"+g),h<10&&(h="0"+h),g+":"+h+v},d=function(){return r.f},f=function(t){return Object(o.t)(t)?r.f:t.indexOf(r.g)<0?t:t.replace(r.g,r.e)},_=function(t){return!Object(o.t)(t)}},"TWL+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("VAmG");n.d(e,"default",function(){return r.a})},VAmG:function(t,e,n){"use strict";var r=n("GiK3"),o=n.n(r),i=n("KSGD"),u=(n.n(i),n("CIox")),c=n("AdWY"),a=n("HW6M"),s=n.n(a),l=n("/CEQ"),d=n.n(l),f=n("gBd+"),_=n("W8k2"),p=n("QgIF"),b=n("JXTd"),m=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.defaultState={deImage:Object(p.d)()},n._order=null,n._pollTimeout=null,n._poll=function(){n._isMounted&&!Object(c.t)(n._order)&&Object(_.a)(n._order).then(function(t){n._isMounted&&(t.title===n._order.title&&t.message===n._order.message||(n._order=t,Object(c.t)(t.title)?n.reset():n.forceUpdate()),t.expected_time!==n._order.expected_time&&(n._order=t,n.forceUpdate()),null===n._order||Object(_.c)(n._order)||setTimeout(function(){n._isMounted&&n.reset()},f.a))}).catch(function(){}).then(function(){n._isMounted&&!Object(c.t)(n._order)&&n.startPolling()})},n.reset=function(){n._order=null,n.stopPolling(),n.props.fetchLaunchData()},n.goToTrackOrder=function(t){u.browserHistory.push(Object(c.k)(f.f,n._orderKey))},n.state=n.defaultState,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.a.PureComponent),m(e,[{key:"_init",value:function(){var t=this;Object(c.t)(this.props.trackData)||Object(_.b)(this.props.trackData).then(function(e){t._isMounted&&Object(_.c)(e)&&window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t._isMounted&&(t._order=e,t._orderKey=e.order_key,t.props.show(),t.startPolling(),t._updateDEImage())})})}).catch(function(e){Object(c.f)(e),t.reset()})}},{key:"componentDidMount",value:function(){this._isMounted=!0,this._init()}},{key:"componentDidUpdate",value:function(t,e){t.trackData!==this.props.trackData&&this._init()}},{key:"startPolling",value:function(){Object(_.c)(this._order)&&(this.stopPolling(),this._pollTimeout=setTimeout(this._poll,f.d))}},{key:"stopPolling",value:function(){clearTimeout(this._pollTimeout)}},{key:"render",value:function(){var t;if(!this.props.visible||Object(c.t)(this._order)||Object(c.t)(this.props.trackData))return null;var e=Object(b.a)(this._order),n="";e&&(n=Object(c.k)(f.e.ETA_MIN,Object(b.o)(this._order)));var r=s()((g(t={},d.a.container,!0),g(t,d.a.containerHide,this.props.willHide),t)),i=this.state.deImage;return o.a.createElement("div",{className:r,onClick:this.goToTrackOrder},e?o.a.createElement("span",{className:d.a.contentETA},n):o.a.createElement("span",{className:d.a.contentStatus},f.e.STATUS),o.a.createElement("div",{className:d.a.content},o.a.createElement("div",{className:d.a.contentTitle},this._order.title),o.a.createElement("div",{className:d.a.contentDescription},Object(c.D)(this._order.message))),o.a.createElement("div",{className:d.a.iconCtr},o.a.createElement("div",{className:d.a.icon},o.a.createElement("img",{src:i,className:d.a.iconImg}))))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.stopPolling()}},{key:"_setState",value:function(t,e){this._isMounted&&this.setState(t,e)}},{key:"_updateDEImage",value:function(){var t=this,e=Object(b.i)(this._order),n=Object(p.c)(e),r=new Image;r.onload=function(){t._setState({deImage:n})},r.src=n}}]),e}();e.a=h,h.defaultProps={trackData:{}}},W8k2:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return u}),n.d(e,"c",function(){return c});var r=n("AdWY"),o=n("W2Wz"),i=(n("gBd+"),function(t){return Object(o.V)({order_id:t.order_id,type:"full",is_nudge:!0}).then(function(e){return n=e,o=t,Object(r.t)(n)?Promise.reject():{title:n.message_position_text,message:n.message,order_id:n.order_id,annotation:n.annotation,status_code:n.status_code,order_key:o.key,image_url:n.image_url,show_eta:n.show_eta,expected_time:n.expected_time};var n,o})}),u=function(t){if(Object(r.t)(t)||Object(r.t)(t.orders))return Promise.reject();var e=t.orders[t.orders.length-1];return 1!==e.trackable?Promise.reject():Object(o.M)({order_id:e.order_id,type:"full"}).then(function(t){return Object(r.t)(t)||Object(r.t)(t.orders)?Promise.reject():i(t.orders[0])})},c=function(t){return 0===t.status_code}},"gBd+":function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"g",function(){return o}),n.d(e,"b",function(){return i}),n.d(e,"d",function(){return u}),n.d(e,"a",function(){return c}),n.d(e,"e",function(){return a}),n.d(e,"f",function(){return s});var r="others_pin_tracking",o="work_pin_tracking",i="home_pin_tracking",u=3e4,c=1e3,a={STATUS:"Status",ETA_MIN:"ETA: {0} mins"},s="/order-track/{0}"}});